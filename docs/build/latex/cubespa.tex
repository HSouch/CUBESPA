%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax
\ifdefined\pdfimageresolution
    \pdfimageresolution= \numexpr \dimexpr1in\relax/\sphinxpxdimen\relax
\fi
%% let collapsible pdf bookmarks panel have high depth per default
\PassOptionsToPackage{bookmarksdepth=5}{hyperref}

\PassOptionsToPackage{warn}{textcomp}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
% support both utf8 and utf8x syntaxes
  \ifdefined\DeclareUnicodeCharacterAsOptional
    \def\sphinxDUC#1{\DeclareUnicodeCharacter{"#1}}
  \else
    \let\sphinxDUC\DeclareUnicodeCharacter
  \fi
  \sphinxDUC{00A0}{\nobreakspace}
  \sphinxDUC{2500}{\sphinxunichar{2500}}
  \sphinxDUC{2502}{\sphinxunichar{2502}}
  \sphinxDUC{2514}{\sphinxunichar{2514}}
  \sphinxDUC{251C}{\sphinxunichar{251C}}
  \sphinxDUC{2572}{\textbackslash}
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}



\usepackage{tgtermes}
\usepackage{tgheros}
\renewcommand{\ttdefault}{txtt}



\usepackage[Bjarne]{fncychap}
\usepackage{sphinx}

\fvset{fontsize=auto}
\usepackage{geometry}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}

\addto\captionsenglish{\renewcommand{\contentsname}{Contents:}}

\usepackage{sphinxmessages}
\setcounter{tocdepth}{1}



\title{CubeSPA}
\date{Dec 30, 2023}
\release{}
\author{Harrison Souchereau}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{}
\makeindex
\begin{document}

\ifdefined\shorthandoff
  \ifnum\catcode`\=\string=\active\shorthandoff{=}\fi
  \ifnum\catcode`\"=\active\shorthandoff{"}\fi
\fi

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{index::doc}}


\sphinxAtStartPar
\sphinxstylestrong{CubeSPA} is a fully\sphinxhyphen{}featured set of utilities to process, analyze, and display useful information of datacubes, particularly
of astronomical data. It fully supports utilities such as moment map creation, spectral analysis, position\sphinxhyphen{}velocity diagrams, and
many others.

\sphinxAtStartPar
To use \sphinxstylestrong{CubeSPA}, install it using

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{pip install cubespa}} (not yet, but soon)

\sphinxAtStartPar
To begin using CubeSPA, create a \sphinxcode{\sphinxupquote{cubespa.CubeSPA}} object with the filename for your cube in the following way:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{filename} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{path/to/cube.fits}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{c} \PYG{o}{=} \PYG{n}{cubespa}\PYG{o}{.}\PYG{n}{CubeSPA}\PYG{p}{(}\PYG{n}{cube\PYGZus{}fn}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
You can load in moment maps (assuming the convention from  \sphinxhref{https://github.com/tonywong94/maskmoment}{maskmoment} ) with the following. If your maskmoment output is
\sphinxcode{\sphinxupquote{path/to/maskmoment.mom0.fits.gz}}, for the moment 0 map (.mom1, .mom2 for the others), these are loaded as follows below. With
moment maps loaded, you can also create a bounding box around “valid” data by calling the \sphinxcode{\sphinxupquote{limits = "auto"}} feature.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{filename} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{path/to/cube.fits}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{mommaps} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{path/to/maskmoment}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{c} \PYG{o}{=} \PYG{n}{cubespa}\PYG{o}{.}\PYG{n}{CubeSPA}\PYG{p}{(}\PYG{n}{cube\PYGZus{}fn}\PYG{p}{,} \PYG{n}{mom\PYGZus{}maps}\PYG{o}{=}\PYG{n}{mommaps}\PYG{p}{,} \PYG{n}{limits}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{auto}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
See getting\_started.rst for more information.


\chapter{Loading Data}
\label{\detokenize{index:loading-data}}
\sphinxstepscope


\section{Getting Started}
\label{\detokenize{getting_started:getting-started}}\label{\detokenize{getting_started::doc}}
\sphinxAtStartPar
The following documentation outlines how to load in data, from an initial cube, to moment maps, to additional data
in both single frame and RGB image form.


\subsection{Initial CubeSPA object}
\label{\detokenize{getting_started:initial-cubespa-object}}
\sphinxAtStartPar
To begin using CubeSPA, create a \sphinxcode{\sphinxupquote{cubespa.CubeSPA}} object with the filename for your cube in the following way:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{import} \PYG{n+nn}{cubespa}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{filename} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{path/to/cube.fits}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{c} \PYG{o}{=} \PYG{n}{cubespa}\PYG{o}{.}\PYG{n}{CubeSPA}\PYG{p}{(}\PYG{n}{cube\PYGZus{}fn}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
You can load in moment maps (assuming the convention from  \sphinxhref{https://github.com/tonywong94/maskmoment}{maskmoment} ) with the following. If your maskmoment output is
\sphinxcode{\sphinxupquote{path/to/maskmoment.mom0.fits.gz}}, for the moment 0 map (.mom1, .mom2 for the others), these are loaded as follows below. With
moment maps loaded, you can also create a bounding box around “valid” data by calling the \sphinxcode{\sphinxupquote{limits = "auto"}} feature.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{filename} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{path/to/cube.fits}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{mommaps} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{path/to/maskmoment}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{c} \PYG{o}{=} \PYG{n}{cubespa}\PYG{o}{.}\PYG{n}{CubeSPA}\PYG{p}{(}\PYG{n}{cube\PYGZus{}fn}\PYG{p}{,} \PYG{n}{mom\PYGZus{}maps}\PYG{o}{=}\PYG{n}{mommaps}\PYG{p}{,} \PYG{n}{limits}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{auto}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}


\subsection{Additional data}
\label{\detokenize{getting_started:additional-data}}
\sphinxAtStartPar
Additional data that doesn’t require a full cube object can be loaded as a \sphinxcode{\sphinxupquote{cubespa.DataSet()}} object.
Note that all of the data in the cubeSPA object loaded above are also cubespa.DataSet() objects, which stores
the wcs and header information for easier access.

\sphinxAtStartPar
For example, if you had an H\sphinxhyphen{}alpha map of your galaxy, you might load it as follows:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{halpha} \PYG{o}{=} \PYG{n}{cubespa}\PYG{o}{.}\PYG{n}{load\PYGZus{}data}\PYG{p}{(}\PYG{n}{halpha\PYGZus{}fn}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{HALPHA}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
However, this map might not be aligned with your cube. CubeSPA uses the \sphinxhref{https://reproject.readthedocs.io/en/stable/}{reproject}
package to properly align maps together. Once you have your \sphinxcode{\sphinxupquote{DataSet}} object, you can align it with

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{halpha\PYGZus{}interp} \PYG{o}{=} \PYG{n}{cubespa}\PYG{o}{.}\PYG{n}{align\PYGZus{}image}\PYG{p}{(}\PYG{n}{c}\PYG{o}{.}\PYG{n}{mom\PYGZus{}maps}\PYG{o}{.}\PYG{n}{mom0}\PYG{p}{,} \PYG{n}{halpha}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
where we are using the moment 0 map to align the images. CubeSPA \sphinxstyleemphasis{should} be able to automatically
align images with a cube directly, where it will do some wcs \sphinxcode{\sphinxupquote{dropaxis}} trickery to try and match things
together.

\sphinxAtStartPar
Lastly, it is good practice to add these datasets to the parent CubeSPA object’s \sphinxcode{\sphinxupquote{additional\_maps}} attribute:

\sphinxAtStartPar
\textgreater{}\textgreater{} c.additional\_maps.extend({[}halpha\_interp, (…){]})


\subsection{RGB images}
\label{\detokenize{getting_started:rgb-images}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{matplotlib}} is notoriously tricky for RGB images of astronomical data. CubeSPA has some built\sphinxhyphen{}in features
to improve the experience with displaying RGB data, particularly HST images.

\sphinxAtStartPar
For example, if we load in an hst image and then create an aligned image, we can see what it looks like by
default with the following code:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{hst} \PYG{o}{=} \PYG{n}{cubespa}\PYG{o}{.}\PYG{n}{load\PYGZus{}data}\PYG{p}{(}\PYG{n}{hst\PYGZus{}fn}\PYG{p}{,} \PYG{n}{rgb\PYGZus{}index}\PYG{o}{=}\PYG{k+kc}{None}\PYG{p}{,} \PYG{n}{label}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{HST}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{hst\PYGZus{}interp} \PYG{o}{=} \PYG{n}{cubespa}\PYG{o}{.}\PYG{n}{align\PYGZus{}image}\PYG{p}{(}\PYG{n}{c}\PYG{o}{.}\PYG{n}{mom\PYGZus{}maps}\PYG{o}{.}\PYG{n}{mom0}\PYG{p}{,} \PYG{n}{hst}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{test} \PYG{o}{=} \PYG{n}{hst\PYGZus{}interp}\PYG{o}{.}\PYG{n}{data}\PYG{o}{.}\PYG{n}{transpose}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{} Transpose the data into the proper rgb pixel format for matplotlib}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cubespa}\PYG{o}{.}\PYG{n}{plotting}\PYG{o}{.}\PYG{n}{plot\PYGZus{}rgb}\PYG{p}{(}\PYG{n}{test}\PYG{p}{,} \PYG{n}{lims}\PYG{o}{=}\PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{n}{c}\PYG{o}{.}\PYG{n}{limits}\PYG{p}{)}\PYG{p}{,} \PYG{n}{outname}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{./rgb\PYGZus{}nonorm.png}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
This returns the following.

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{rgb_nonorm}.png}

\sphinxAtStartPar
The RGB image can be histogram\sphinxhyphen{}normalized by doing the following:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{norm} \PYG{o}{=} \PYG{n}{cubespa}\PYG{o}{.}\PYG{n}{normalized\PYGZus{}rgb\PYGZus{}image}\PYG{p}{(}\PYG{n}{hst\PYGZus{}interp}\PYG{o}{.}\PYG{n}{data}\PYG{p}{,} \PYG{n}{sigma}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cubespa}\PYG{o}{.}\PYG{n}{plotting}\PYG{o}{.}\PYG{n}{plot\PYGZus{}rgb}\PYG{p}{(}\PYG{n}{norm}\PYG{p}{,} \PYG{n}{lims}\PYG{o}{=}\PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{n}{c}\PYG{o}{.}\PYG{n}{limits}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
where \sphinxcode{\sphinxupquote{sigma}} defines the lower and upper bounds to stretch each RGB frame to. This returns a map that
look like:

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{rgb_norm}.png}

\sphinxAtStartPar
If the user wants to look at faint features, simply decrease the upper stretch. This will increase the visibility
of faint features at the cost of saturating the central disk.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{norm} \PYG{o}{=} \PYG{n}{cubespa}\PYG{o}{.}\PYG{n}{normalized\PYGZus{}rgb\PYGZus{}image}\PYG{p}{(}\PYG{n}{hst\PYGZus{}interp}\PYG{o}{.}\PYG{n}{data}\PYG{p}{,} \PYG{n}{sigma}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cubespa}\PYG{o}{.}\PYG{n}{plotting}\PYG{o}{.}\PYG{n}{plot\PYGZus{}rgb}\PYG{p}{(}\PYG{n}{norm}\PYG{p}{,} \PYG{n}{lims}\PYG{o}{=}\PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{n}{c}\PYG{o}{.}\PYG{n}{limits}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics[width=400\sphinxpxdimen]{{rgb_faint}.png}


\subsection{Cutouts and Regions}
\label{\detokenize{getting_started:cutouts-and-regions}}
\sphinxAtStartPar
To create specific cutouts (for analysis of certain regions), the user supplies the parent CubeSPA object,
the central location of the cutout, and the size of the cutout (either as an int, for a square, or as a
tuple to establish a rectangular region). The output is a new CubeSPA object where the cube, moment maps,
and any additional maps are trimmed to the location and size of the cutout.

\sphinxAtStartPar
For example, if I was looking at 3 different regions (blob, fallback, and outskirts) for some datacube of a
galaxy, I would create it with the following.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{blob} \PYG{o}{=} \PYG{n}{cubespa}\PYG{o}{.}\PYG{n}{gen\PYGZus{}cutout}\PYG{p}{(}\PYG{n}{c}\PYG{p}{,} \PYG{p}{(}\PYG{l+m+mi}{345}\PYG{p}{,} \PYG{l+m+mi}{290}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mi}{15}\PYG{p}{,} \PYG{n}{show\PYGZus{}bbox}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{fallback} \PYG{o}{=} \PYG{n}{cubespa}\PYG{o}{.}\PYG{n}{gen\PYGZus{}cutout}\PYG{p}{(}\PYG{n}{c}\PYG{p}{,} \PYG{p}{(}\PYG{l+m+mi}{305}\PYG{p}{,} \PYG{l+m+mi}{310}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+m+mi}{20}\PYG{p}{,} \PYG{l+m+mi}{15}\PYG{p}{)}\PYG{p}{,} \PYG{n}{show\PYGZus{}bbox}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{outskirts} \PYG{o}{=} \PYG{n}{cubespa}\PYG{o}{.}\PYG{n}{gen\PYGZus{}cutout}\PYG{p}{(}\PYG{n}{c}\PYG{p}{,} \PYG{p}{(}\PYG{l+m+mi}{270}\PYG{p}{,} \PYG{l+m+mi}{403}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+m+mi}{15}\PYG{p}{,} \PYG{l+m+mi}{35}\PYG{p}{)}\PYG{p}{,} \PYG{n}{show\PYGZus{}bbox}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
The additional parameter \sphinxcode{\sphinxupquote{show\_bbox}} will generate a plot to show you where the cutout falls on the parent
image. This is helpful for more closely aligning the cutouts.


\subsection{Reference/API}
\label{\detokenize{getting_started:module-cubespa.cubespa}}\label{\detokenize{getting_started:reference-api}}\index{module@\spxentry{module}!cubespa.cubespa@\spxentry{cubespa.cubespa}}\index{cubespa.cubespa@\spxentry{cubespa.cubespa}!module@\spxentry{module}}\index{CubeSPA (class in cubespa.cubespa)@\spxentry{CubeSPA}\spxextra{class in cubespa.cubespa}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{getting_started:cubespa.cubespa.CubeSPA}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{class\DUrole{w}{  }}}\sphinxcode{\sphinxupquote{cubespa.cubespa.}}\sphinxbfcode{\sphinxupquote{CubeSPA}}}{\emph{\DUrole{n}{cube}}, \emph{\DUrole{n}{data\_index}\DUrole{o}{=}\DUrole{default_value}{0}}, \emph{\DUrole{n}{mom\_maps}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{additional\_maps}\DUrole{o}{=}\DUrole{default_value}{{[}{]}}}, \emph{\DUrole{n}{center}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{position\_angle}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{eps}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{limits}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{plot\_dir}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{o}{**}\DUrole{n}{kwargs}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}
\index{create\_spectra() (cubespa.cubespa.CubeSPA method)@\spxentry{create\_spectra()}\spxextra{cubespa.cubespa.CubeSPA method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{getting_started:cubespa.cubespa.CubeSPA.create_spectra}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{create\_spectra}}}{\emph{\DUrole{n}{position}}, \emph{\DUrole{n}{size}}, \emph{\DUrole{n}{return\_products}\DUrole{o}{=}\DUrole{default_value}{False}}, \emph{\DUrole{n}{plot}\DUrole{o}{=}\DUrole{default_value}{False}}}{}
\pysigstopsignatures
\end{fulllineitems}

\index{load\_dir() (cubespa.cubespa.CubeSPA method)@\spxentry{load\_dir()}\spxextra{cubespa.cubespa.CubeSPA method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{getting_started:cubespa.cubespa.CubeSPA.load_dir}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{load\_dir}}}{}{}
\pysigstopsignatures
\end{fulllineitems}

\index{plot\_moment\_maps() (cubespa.cubespa.CubeSPA method)@\spxentry{plot\_moment\_maps()}\spxextra{cubespa.cubespa.CubeSPA method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{getting_started:cubespa.cubespa.CubeSPA.plot_moment_maps}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{plot\_moment\_maps}}}{\emph{\DUrole{n}{use\_limits}\DUrole{o}{=}\DUrole{default_value}{True}}, \emph{\DUrole{o}{*}\DUrole{n}{kwargs}}}{}
\pysigstopsignatures
\end{fulllineitems}

\index{velocities\_from\_wcs() (cubespa.cubespa.CubeSPA method)@\spxentry{velocities\_from\_wcs()}\spxextra{cubespa.cubespa.CubeSPA method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{getting_started:cubespa.cubespa.CubeSPA.velocities_from_wcs}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{velocities\_from\_wcs}}}{}{}
\pysigstopsignatures
\end{fulllineitems}


\end{fulllineitems}

\index{check\_kwarg() (in module cubespa.cubespa)@\spxentry{check\_kwarg()}\spxextra{in module cubespa.cubespa}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{getting_started:cubespa.cubespa.check_kwarg}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxcode{\sphinxupquote{cubespa.cubespa.}}\sphinxbfcode{\sphinxupquote{check\_kwarg}}}{\emph{\DUrole{n}{key}}, \emph{\DUrole{n}{default}}, \emph{\DUrole{n}{kwargs}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{dict}}}{}
\pysigstopsignatures
\end{fulllineitems}



\chapter{2D Analysis}
\label{\detokenize{index:d-analysis}}
\sphinxstepscope


\section{Generating Moment Maps}
\label{\detokenize{momentmaps:generating-moment-maps}}\label{\detokenize{momentmaps::doc}}
\sphinxAtStartPar
Generating moment maps is trivially easy using CubeSPA.

\sphinxAtStartPar
To make a display of the moment maps, simply do the following:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{import} \PYG{n+nn}{cubespa}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{c} \PYG{o}{=} \PYG{n}{cubespa}\PYG{o}{.}\PYG{n}{CubeSPA}\PYG{p}{(}\PYG{n}{cube\PYGZus{}filename}\PYG{p}{,} \PYG{n}{mom\PYGZus{}maps}\PYG{o}{=}\PYG{n}{mom\PYGZus{}maps\PYGZus{}filename}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{c}\PYG{o}{.}\PYG{n}{plot\PYGZus{}moment\PYGZus{}maps}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
If you have made some cutouts of your object, you can do the same, but it is recommended that you
set \sphinxcode{\sphinxupquote{use\_limits}} to \sphinxcode{\sphinxupquote{False}} as the limits are related directly to the parent cube object.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{blob}\PYG{o}{.}\PYG{n}{plot\PYGZus{}moment\PYGZus{}maps}\PYG{p}{(}\PYG{n}{use\PYGZus{}limits}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics[width=800\sphinxpxdimen]{{blob}.png}


\subsection{Reference/API}
\label{\detokenize{momentmaps:module-cubespa.plotting.mommap_plots}}\label{\detokenize{momentmaps:reference-api}}\index{module@\spxentry{module}!cubespa.plotting.mommap\_plots@\spxentry{cubespa.plotting.mommap\_plots}}\index{cubespa.plotting.mommap\_plots@\spxentry{cubespa.plotting.mommap\_plots}!module@\spxentry{module}}\index{moment\_map\_plot() (in module cubespa.plotting.mommap\_plots)@\spxentry{moment\_map\_plot()}\spxextra{in module cubespa.plotting.mommap\_plots}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{momentmaps:cubespa.plotting.mommap_plots.moment_map_plot}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxcode{\sphinxupquote{cubespa.plotting.mommap\_plots.}}\sphinxbfcode{\sphinxupquote{moment\_map\_plot}}}{\emph{\DUrole{n}{cubespa\_obj}}, \emph{\DUrole{n}{filename}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{use\_limits}\DUrole{o}{=}\DUrole{default_value}{True}}, \emph{\DUrole{o}{**}\DUrole{n}{kwargs}}}{}
\pysigstopsignatures
\sphinxAtStartPar
\_summary\_
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{cubespa\_obj}} ({\hyperref[\detokenize{getting_started:cubespa.cubespa.CubeSPA}]{\sphinxcrossref{\sphinxstyleliteralemphasis{\sphinxupquote{cubespa.CubeSPA}}}}}) \textendash{} The input CubeSPA object, with valid moment maps loaded.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{filename}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Output filename, in which the plot is just shown instead of saved. Defaults to None.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{use\_limits}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} 
\sphinxAtStartPar
Whether or not to use limits from the CubeSPA object.

\sphinxAtStartPar
It is a good idea to set to False for cutout objects, as their limits will be relative to the initial CubeSPA object,
and their desired limits will be the entire array. Defaults to True.


\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}


\sphinxstepscope


\section{Making Overlays}
\label{\detokenize{overlays:making-overlays}}\label{\detokenize{overlays::doc}}
\sphinxAtStartPar
Overlays are useful features to display isophotal contours of one image onto another.

\sphinxAtStartPar
Once you have aligned datasets (see getting\_started), you can create an overlay by using:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cubespa}\PYG{o}{.}\PYG{n}{plotting}\PYG{o}{.}\PYG{n}{overlay\PYGZus{}plot}\PYG{p}{(}\PYG{n}{c}\PYG{o}{.}\PYG{n}{mom\PYGZus{}maps}\PYG{o}{.}\PYG{n}{mom0}\PYG{p}{,} \PYG{n}{c}\PYG{o}{.}\PYG{n}{additional\PYGZus{}maps}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,}
\PYG{g+gp}{... }                              \PYG{n}{lims}\PYG{o}{=}\PYG{n}{c}\PYG{o}{.}\PYG{n}{limits}\PYG{p}{,} \PYG{n}{levels}\PYG{o}{=}\PYG{p}{[}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{l+m+mi}{20}\PYG{p}{,} \PYG{l+m+mi}{100}\PYG{p}{,} \PYG{l+m+mi}{150}\PYG{p}{]}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
where in this instance, we are showing the moment 0 CO distribution with H\sphinxhyphen{}alpha contours overlaid in black.
The output plot looks like this:

\noindent\sphinxincludegraphics[width=600\sphinxpxdimen]{{test_overlay}.png}

\sphinxAtStartPar
For an RGB image, use the following instead:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{norm} \PYG{o}{=} \PYG{n}{cubespa}\PYG{o}{.}\PYG{n}{normalized\PYGZus{}rgb\PYGZus{}image}\PYG{p}{(}\PYG{n}{hst\PYGZus{}interp}\PYG{o}{.}\PYG{n}{data}\PYG{p}{,} \PYG{n}{sigma}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cubespa}\PYG{o}{.}\PYG{n}{plotting}\PYG{o}{.}\PYG{n}{rgb\PYGZus{}overlay}\PYG{p}{(}\PYG{n}{norm}\PYG{p}{,} \PYG{n}{c}\PYG{o}{.}\PYG{n}{mom\PYGZus{}maps}\PYG{o}{.}\PYG{n}{mom0}\PYG{p}{,}
\PYG{g+gp}{... }                             \PYG{n}{levels}\PYG{o}{=}\PYG{p}{[}\PYG{l+m+mf}{0.02}\PYG{p}{,} \PYG{l+m+mf}{0.05}\PYG{p}{,} \PYG{l+m+mf}{0.1}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{n}{lims}\PYG{o}{=}\PYG{n}{blob}\PYG{o}{.}\PYG{n}{limits}\PYG{p}{,} \PYG{n}{colors}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{white}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\noindent\sphinxincludegraphics[width=600\sphinxpxdimen]{{rgb_overlay}.png}

\sphinxAtStartPar
which plots CO contours on top of the HST RGB image, which for this region reveals
a small compact stellar feature at the head of the  “blob”.


\chapter{Cube Analysis}
\label{\detokenize{index:cube-analysis}}
\sphinxstepscope


\section{Spectral Analysis}
\label{\detokenize{spectra:spectral-analysis}}\label{\detokenize{spectra::doc}}
\sphinxAtStartPar
To generate spectra, the user specifies the location of the aperture (elliptical by default), and the shape.
Continuing with our \sphinxcode{\sphinxupquote{blob}} example, we generate spectra like so:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{blob}\PYG{o}{.}\PYG{n}{create\PYGZus{}spectra}\PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{15}\PYG{p}{,} \PYG{l+m+mi}{13}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{,} \PYG{l+m+mi}{6}\PYG{p}{)}\PYG{p}{,} \PYG{n}{plot}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
This creates the following plot, showing the location of the spectral features in either velocity or channel
space. CubeSPA uses sigma clipping to determine an RMS of the spectra, and then plots the 1,2 and 3\sphinxhyphen{}sigma levels
as a shaded grey region.

\noindent\sphinxincludegraphics[width=800\sphinxpxdimen]{{blob_spectra}.png}

\sphinxstepscope


\section{Position\sphinxhyphen{}Velocity diagrams}
\label{\detokenize{pvds:position-velocity-diagrams}}\label{\detokenize{pvds::doc}}
\sphinxAtStartPar
Position\sphinxhyphen{}velocity diagrams (PVDs) plot the strength of velocity features along some specified path, most often
along the major and minor axes. A disk with only circular motions will show the rotation curve along the
major axis, and should be flat along the minor axis. Therefore, PVDs are useful tools to find non\sphinxhyphen{}circular
velocity features without explicit modeling of components.

\sphinxAtStartPar
To generate a PVD, do the following:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{pvd} \PYG{o}{=} \PYG{n}{cubespa}\PYG{o}{.}\PYG{n}{gen\PYGZus{}pvd}\PYG{p}{(}\PYG{n}{blob}\PYG{p}{,} \PYG{p}{(}\PYG{l+m+mi}{15}\PYG{p}{,} \PYG{l+m+mi}{12}\PYG{p}{)}\PYG{p}{,} \PYG{l+m+mi}{25}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{width}\PYG{o}{=}\PYG{l+m+mi}{8}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cubespa}\PYG{o}{.}\PYG{n}{plotting}\PYG{o}{.}\PYG{n}{pvd\PYGZus{}plot}\PYG{p}{(}\PYG{n}{blob}\PYG{p}{,} \PYG{n}{pvd}\PYG{p}{,} \PYG{n}{vmin}\PYG{o}{=}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{125}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
Wich will spit out both the map of the region with the overlaid PVD path (with proper width displayed), as
well as the PVD itself. In the example, the region of the PVD cutting through the “blob” shows emission in
blue\sphinxhyphen{}shifted velocity channels, consistent with what is seen in the moment 1 mean velocity map.

\noindent\sphinxincludegraphics[width=600\sphinxpxdimen]{{example_pvd}.png}


\chapter{Coming soon}
\label{\detokenize{index:coming-soon}}
\sphinxstepscope


\section{Generating / Fitting Velocity Models}
\label{\detokenize{modeling:generating-fitting-velocity-models}}\label{\detokenize{modeling::doc}}

\chapter{Indices and tables}
\label{\detokenize{index:indices-and-tables}}\begin{itemize}
\item {} 
\sphinxAtStartPar
\DUrole{xref,std,std-ref}{genindex}

\item {} 
\sphinxAtStartPar
\DUrole{xref,std,std-ref}{modindex}

\item {} 
\sphinxAtStartPar
\DUrole{xref,std,std-ref}{search}

\end{itemize}


\renewcommand{\indexname}{Python Module Index}
\begin{sphinxtheindex}
\let\bigletter\sphinxstyleindexlettergroup
\bigletter{c}
\item\relax\sphinxstyleindexentry{cubespa.cubespa}\sphinxstyleindexpageref{getting_started:\detokenize{module-cubespa.cubespa}}
\item\relax\sphinxstyleindexentry{cubespa.plotting.mommap\_plots}\sphinxstyleindexpageref{momentmaps:\detokenize{module-cubespa.plotting.mommap_plots}}
\end{sphinxtheindex}

\renewcommand{\indexname}{Index}
\printindex
\end{document}